<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">

<body>
<p>
    Оператор нулевого слияния (??)
    Оператор нулевого слияния представляет собой два вопросительных знака ??.

    Так как он обрабатывает null и undefined одинаковым образом, то для этой статьи мы введём специальный термин. Для краткости будем говорить, что значение «определено», если оно не равняется ни null, ни undefined.

    Результат выражения a ?? b будет следующим:

    если a определено, то a,
    если a не определено, то b.
    Иначе говоря, оператор ?? возвращает первый аргумент, если он не null/undefined, иначе второй.
</p>
<p>
    Вот как можно переписать выражение result = a ?? b, используя уже знакомые нам операторы:

    result = (a !== null && a !== undefined) ? a : b;
    Как правило, оператор ?? нужен для того, чтобы задать значение по умолчанию для потенциально неопределённой переменной.

    Например, здесь мы отобразим user, если её значение не null/undefined, в противном случае Аноним:

    let user;

    alert(user ?? "Аноним"); // Аноним (user не существует)
    А вот пример, когда user присвоено значение:

    let user = "Иван";

    alert(user ?? "Аноним"); // Иван (user существует)

</p>
<p>
    Кроме этого, можно записать последовательность из операторов ??, чтобы получить первое значение из списка, которое не является null/undefined.

    Допустим, у нас есть данные пользователя в переменных firstName, lastName или nickName. Все они могут не существовать, если пользователь решил не вводить соответствующие значение.

    Мы хотели бы отобразить имя пользователя, используя одну из этих переменных, или показать «Аноним», если все они null/undefined.

    Для этого воспользуемся оператором ??:

    let firstName = null;
    let lastName = null;
    let nickName = "Суперкодер";

    // показывает первое значение, которое определено:
    alert(firstName ?? lastName ?? nickName ?? "Аноним"); // Суперкодер
</p>
<p>
    Оператор ИЛИ || можно использовать для того же, что и ??, как это было показано в предыдущей главе.

    Например, если в приведённом выше коде заменить ?? на ||, то будет тот же самый результат:

    let firstName = null;
    let lastName = null;
    let nickName = "Суперкодер";

    // показывает первое истинное значение:
    alert(firstName || lastName || nickName || "Аноним"); // Суперкодер

</p>
<p>
    Важное различие между ними заключается в том, что:

    || возвращает первое истинное значение.
    ?? возвращает первое определённое значение.
</p>
<p>
    Рассмотрим следующий пример:

    let height = 0;

    alert(height || 100); // 100
    alert(height ?? 100); // 0
    height || 100 проверяет height на ложное значение, оно равно 0, да, ложное.
    поэтому результатом || является второй аргумент, т.е. 100.
    height ?? 100 проверяет, что переменная height содержит null/undefined, а поскольку это не так,
    то результатом является сама переменная height, т.е. 0.
</p>
<p>
    Использование ?? вместе с && или ||
    По соображениям безопасности JavaScript запрещает использование оператора ?? вместе с && и ||, если приоритет явно не указан при помощи круглых скобок.

    Выполнение следующего кода приведёт к синтаксической ошибке:

    let x = 1 && 2 ?? 3; // Синтаксическая ошибка
    Это, безусловно, спорное ограничение было добавлено в спецификацию языка с целью избежать программные ошибки, когда люди начнут переходить с || на ??.

    Используйте скобки, чтобы обойти это ограничение:

    let x = (1 && 2) ?? 3; // Работает без ошибок

</p>
<p>
    Предположим, нам необходимо проверить, равна ли переменная null или undefined, и если это так — присвоить этой переменной какое-либо другое значение.

    Вот как мы сделали бы это сейчас:

    let userAge = null;

    if (userAge === null || userAge === undefined) {
    userAge = 18;
    }
    Выглядит громоздко, правда? Существует оператор, более подходящий для подобных задач. Вот его синтаксис:

    x ??= y
    Оператор ??= присвоит x значение y только в том случае, если x не определено (null/undefined).

    Теперь попробуем переписать уже знакомый нам фрагмент кода используя новый оператор:

    let userAge = null;

    userAge ??= 18;

    alert(userAge) // 18
</p>
</body>
</html>